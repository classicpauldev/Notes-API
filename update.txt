Refactored Note service for maintainability
